<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>pyCHNOSZ.fun API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>pyCHNOSZ.fun</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import os
import warnings
from contextlib import contextmanager
from IPython.display import Image, display
import pandas as pd

with warnings.catch_warnings():
    warnings.simplefilter(&#34;ignore&#34;)
    
    import rpy2.robjects as ro
    from rpy2.robjects.packages import importr
    from rpy2.robjects import pandas2ri
    from rpy2.robjects.lib import grdevices
    
    pandas2ri.activate()
    
    CHNOSZ = importr(&#34;CHNOSZ&#34;)
    grdev = importr(&#39;grDevices&#39;)


@contextmanager
def __r_inline_plot(width=600, height=600, dpi=100):
    
    &#34;&#34;&#34;
    Display R plots inline.

    Parameters
    ----------
    width, height : int or float, default 600
        Width and height of the plot.
    dpi : int or float, default 100
        Resolution of the plot.
    &#34;&#34;&#34;
    
    with grdevices.render_to_bytesio(grdevices.png, 
                                     width=width,
                                     height=height, 
                                     res=dpi) as b:

        yield

    data = b.getvalue()
    display(Image(data=data, format=&#39;png&#39;, embed=True))

    
def _convert_to_RVector(value, force_Rvec=True):
    
    &#34;&#34;&#34;
    Convert a value or list into an R vector of the appropriate type.
    
    Parameters
    ----------
    value : numeric or str, or list of numeric or str
        Value to be converted.
    
    force_Rvec : bool, default True
        If `value` is not a list, force conversion into a R vector?
        False will return an int, float, or str if value is non-list.
        True will always return an R vector.
    
    Returns
    -------
    int, float, str, an rpy2 R vector
        A value or R vector of an appropriate data type.
    &#34;&#34;&#34;
    
    if not isinstance(value, list) and not force_Rvec:
        return value
    elif not isinstance(value, list) and force_Rvec:
        value = [value]
    else:
        pass
    
    if all(isinstance(x, bool) for x in value):
        return ro.BoolVector(value)
    elif all(isinstance(x, int) for x in value):
        return ro.IntVector(value)
    elif all(isinstance(x, float) or isinstance(x, int) for x in value):
        return ro.FloatVector(value)
    else:
        return ro.StrVector(value)


def equilibrate(aout, balance=None, loga_balance=None, ispecies=None,
                normalize=False, messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the equilibrate() function in CHNOSZ.
    Calculate equilibrium chemical activities of species from the affinities
    of formation of the species at unit activity.
    
    Parameters
    ----------
    aout : rpy2.ListVector
        Output from `affinity`.
    
    balance : str or numeric, optional
        How to balance the transformations.
    
    loga_balance : numeric or list of numeric, optional
        Logarithm of total activity of balanced quantity.
    
    ispecies : numeric, optional
        Which species to include.
    
    normalize : bool, default False
        Normalize the molar formulas of species by the balancing coefficients?
    
    messages : bool, default True
        Display messages from CHNOSZ?
    
    Returns
    -------
    eout : rpy2.ListVector
        Output from `equilibrate`.
    &#34;&#34;&#34;
        
    # stay.normal is an unused argument in equilibrate()?
    
    args = {&#39;aout&#39;:aout, &#39;normalize&#39;:normalize}
    
    if balance != None: args[&#39;balance&#39;] = balance
    if loga_balance != None: args[&#39;loga.balance&#39;] = loga_balance
    if ispecies != None: args[&#39;ispecies&#39;] = _convert_to_RVector(ispecies)

    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        eout = CHNOSZ.equilibrate(**args)

    if messages:
        for warning in w:
            print(warning.message)
    
    return eout


def diagram(eout, ptype=&#39;auto&#39;, alpha=False, normalize=False,
            as_residue=False, balance=None, groups=None,
            xrange=None, mar=None, yline=None, side=[1,2,3,4],
            ylog=True, xlim=None, ylim=None, xlab=None, ylab=None,
            cex=None, cex_names=None, cex_axis=None,
            lty=None, lwd=None, dotted=None,
            spline_method=None, contour_method=None, levels=None,
            col=None, col_names=None, fill=None,
            fill_NA=&#34;gray80&#34;, limit_water=None,
            names=None, format_names=True, bold=False, italic=False, 
            font=None, family=None, adj=0.5,
            dx=0, dy=0, srt=0, min_area=0,
            main=None, legend_x=None,
            add=False, plot_it=True, tplot=True,
            messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the diagram() function in CHNOSZ.
    Plot equilibrium chemical activity (1-D speciation) or equal-activity
    (2-D predominance) diagrams as a function of chemical activities of
    basis species, temperature and/or pressure.
    
    Parameters
    ----------
    eout : rpy2.ListVector
        Output from `equilibrate` or `affinity`.
    
    ptype : str, default &#39;auto&#39;
        Type of plot, or name of basis species whose activity to plot.

    alpha : bool or str (balance), default False
        For speciation diagrams, plot degree of formation instead of
        activities?

    normalize : bool, default False
        Divide chemical affinities by balance coefficients (rescale to whole
        formulas)?

    as_residue : bool, default False
        Divide chemical affinities by balance coefficients (no rescaling)?

    balance : str or numeric, optional
        How to balance the transformations.

    groups : rpy2.ListVector of numeric, optional
        Groups of species to consider as a single effective species.

    xrange : numeric, optional
        Range of x-values between which predominance field boundaries are
        plotted.

    mar : numeric, optional
        Margins of plot frame.

    yline : numeric, optional
        Margin line on which to plot the y-axis name.

    side : numeric, optional
        Which sides of plot to draw axes.

    xlim : numeric, optional
        Limits of x-axis.

    ylim : numeric, optional
        Limits of y-axis.

    xlab : str, optional
        Label to use for x-axis.

    ylab : str, optional
        Label to use for y-axis.

    ylog : bool, optional
        Use a logarithmic y-axis (on 1D degree diagrams)?

    cex : numeric, optional
        Character expansion (scaling relative to current).

    cex_names : numeric, optional
        Character expansion factor to be used for names of species on plots.

    cex_axis : numeric, optional
        Character expansion factor for names of axes.

    lty : numeric, optional
        Line types to be used in plots.

    lwd : numeric, optional
        Line width.

    dotted : numeric, optional
        How often to skip plotting points on predominance field boundaries (to
        gain the effect of dotted or dashed boundary lines).

    spline_method : str, optional
        Method used in splinefun.

    contour_method : str, optional
        Labelling method used in contour (use NULL for no labels).

    levels : numeric, optional
        Levels at which to draw contour lines.

    col : str, optional
        Color of activity lines (1D diagram) or predominance field boundaries
        (2D diagram).

    col_names : str, optional
        Colors for labels of species.

    fill : str, optional
        Colors used to fill predominance fields.

    fill_NA : str, optional
        Color for grid points with NA values.

    limit_water : None or bool, optional
        Set NaN values beyond water stability limits?

    names : str, optional
        Names of species for activity lines or predominance fields.

    format_names : bool, default True
        Apply formatting to chemical formulas?

    bold : bool, default False
        Use bold formatting for names?

    italic : bool, default False
        Use italic formatting for names?

    font : str, optional
        Font type for names (has no effect if format.names is TRUE).

    family : str, optional
        Font family for names.

    adj : numeric, default 0.5
        Adjustment for line labels.

    dx : numeric, default 0
        X offset for line or field labels.

    dy : numeric, default 0
        Y offset for line or field labels.

    srt : numeric, default 0
        Rotation for line labels.

    min_area : numeric, default 0
        Minimum area of fields that should be labeled, expressed as a fraction
        of the total plot area.

    main : str, optional
        A main title for the plot; NULL means to plot no title.

    legend_x : str, optional
        Description of legend placement passed to legend.

    add : bool, default False
        Add to current plot?

    plot_it : bool, default True
        Make a plot?

    tplot : bool, default True
        Set up plot with thermo.plot.new?
    
    messages : bool, default True
        Display messages from CHNOSZ?
    
    Returns
    -------
    a : rpy2.ListVector
        Output from `diagram`.
    args : dict
        Dictionary of arguments supplied to `diagram`.
    &#34;&#34;&#34;
    
    args = {&#39;eout&#39;:eout, &#39;ptype&#39;:ptype, &#39;alpha&#39;:alpha, &#39;normalize&#39;:normalize,
            &#39;as.residue&#39;:as_residue, &#39;ylog&#39;:ylog, &#39;fill.NA&#39;:fill_NA, &#39;format.names&#39;:format_names,
            &#39;bold&#39;:bold, &#39;italic&#39;:italic, &#39;adj&#39;:adj, &#39;dx&#39;:dx, &#39;dy&#39;:dy, &#39;srt&#39;:srt,
            &#39;min.area&#39;:min_area, &#39;plot.it&#39;:plot_it, &#39;tplot&#39;:tplot}
    
    if balance != None: args[&#34;balance&#34;] = balance
    if groups != None: args[&#34;groups&#34;] = groups
    if xrange != None: args[&#34;xrange&#34;] = _convert_to_RVector(xrange)
    if mar != None: args[&#34;mar&#34;] = _convert_to_RVector(mar)
    if yline != None: args[&#34;yline&#34;] = _convert_to_RVector(yline)
    if side != None: args[&#34;side&#34;] = _convert_to_RVector(side)
    if xlim != None: args[&#34;xlim&#34;] = _convert_to_RVector(xlim)
    if ylim != None: args[&#34;ylim&#34;] = _convert_to_RVector(ylim)
    if xlab != None: args[&#34;xlab&#34;] = xlab
    if ylab != None: args[&#34;ylab&#34;] = ylab
    if cex != None: args[&#34;cex&#34;] = _convert_to_RVector(cex)
    if cex_names != None: args[&#34;cex.names&#34;] = _convert_to_RVector(cex_names)
    if cex_axis != None: args[&#34;cex.axis&#34;] = _convert_to_RVector(cex_axis)
    if lty != None: args[&#34;lty&#34;] = _convert_to_RVector(lty)
    if lwd != None: args[&#34;lwd&#34;] = _convert_to_RVector(lwd)
    if dotted != None: args[&#34;dotted&#34;] = convert_to_RVector(dotted)
    if spline_method != None: args[&#34;spline.method&#34;] = spline_method
    if contour_method != None: args[&#34;contour.method&#34;] = contour_method
    if levels != None: args[&#34;levels&#34;] = _convert_to_RVector(levels)
    if col != None: args[&#34;col&#34;] = _convert_to_RVector(col)
    if col_names != None: args[&#34;col.names&#34;] = _convert_to_RVector(col_names)
    if fill != None: args[&#34;fill&#34;] = _convert_to_RVector(fill)
    if limit_water != None: args[&#34;limit.water&#34;] = limit_water
    if names != None: args[&#34;names&#34;] = _convert_to_RVector(names)
    if font != None: args[&#34;font&#34;] = _convert_to_RVector(font)
    if family != None: args[&#34;family&#34;] = _convert_to_RVector(family)
    if main != None: args[&#34;main&#34;] = main
    if legend_x != None: args[&#34;legend.x&#34;] = legend_x
    
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        with __r_inline_plot(width=1024, height=896, dpi=150):
            if isinstance(add, bool):
                if add: # add=&#39;True&#39; does not work with the current pyCHNOSZ framework
                    raise Exception(&#34;The argument &#39;add&#39; must be assigned the output of the previous diagram(s).&#34;)
                else:
                    a = CHNOSZ.diagram(**args)
            elif isinstance(add, list):
                args.update({&#39;add&#39;:True})
                for to_add in add:
                    CHNOSZ.diagram(**to_add)
                a = CHNOSZ.diagram(**args)
                    
            else:
                CHNOSZ.diagram(**add)
                args.update({&#39;add&#39;:True})
                a = CHNOSZ.diagram(**args)
            
    if messages:
        for warning in w:
            print(warning.message)
    
    return a, args


def affinity(property=None, sout=None, exceed_Ttr=False,
             exceed_rhomin=False, return_buffer=False, return_sout=False,
             balance=&#34;PBB&#34;, iprotein=None, loga_protein=-3, transect=None,
             messages=True, **kwargs):

    &#34;&#34;&#34;
    Python wrapper for the affinity() function in CHNOSZ.
    Calculate the chemical affinities of formation reactions of species.
    
    Parameters
    ----------
    property : str, default &#39;A&#39;
        The property to be calculated. Default is A, for chemical affinity of
        formation reactions of species of interest.

    sout : list
        Output from `subcrt`.

    exceed_Ttr : bool, default False
        Allow subcrt to compute properties for phases beyond their transition
        temperature?

    exceed_rhomin : bool, default False
        Allow subcrt to compute properties of species in the HKF model below
        0.35 g cm-3?

    return_buffer : bool, default False
        If TRUE, and a buffer has been associated with one or more basis
        species in the system, return the values of the activities of the basis
        species calculated using the buffer. Default is FALSE.

    return_sout : bool, default False
        Return only the values calculated with subcrt?

    balance : str, default &#39;PBB&#39;
        This argument is used to identify a conserved basis species (or PBB) in
        a chemical activity buffer.

    iprotein : numeric, optional
        Indices of proteins in thermo$protein for which to calculate
        properties.

    loga_protein : numeric, default -3
        Logarithms of activities of proteins identified in iprotein.

    transect : bool, optional
        Force a transect calculation, even for three or fewer values of the
        variables?
    
    messages : bool, default True
        Display messages from CHNOSZ?
        
    **kwargs : dict
        Numeric, zero or more named arguments, used to identify the variables
        of interest in the calculations.
    
    Returns
    -------
    a : rpy2.ListVector
        Output from `affinity`.
    &#34;&#34;&#34;
    
    args = {&#39;exceed_Ttr&#39;:exceed_Ttr, &#39;exceed_rhomin&#39;:exceed_rhomin,
            &#39;return_buffer&#39;:return_buffer, &#39;return_sout&#39;:return_sout,
            &#39;balance&#39;:balance, &#39;loga_protein&#39;:loga_protein}
    
    if property != None: args[&#34;property&#34;] = property
    if sout != None: args[&#34;sout&#34;] = sout
    if iprotein != None: args[&#34;iprotein&#34;] = iprotein
    if transect != None: args[&#34;transect&#34;] = transect
    
    for key, value in kwargs.items():
        if isinstance(value, list):
            value = ro.FloatVector(value)
        args.update({key:value})
        
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        a = CHNOSZ.affinity(**args)

    if messages:
        for warning in w:
            print(warning.message)

    return a

            
def species(species=None, state=None, delete=False, add=False,
            index_return=False, messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the species() function in CHNOSZ.
    Define the species of interest in a system; modify their physical states
    and logarithms of activities.
    
    Parameters
    ----------
    species : str, int, or list of str or int
        Names or formulas of species to add to the species definition; int,
        rownumbers of species to modify or delete.

    state : str or list of str, optional
        physical states; numeric, logarithms of activities or fugacities.

    delete : bool, default False
        Delete the species identified by numeric values of species (or all
        species if that argument is missing)?

    add : bool, default False
        Delete a previous species definition instead of adding to it?

    index_return : bool, default False
        return the affected rownumbers of species in the OBIGT database instead
        of the normal output of `species`?
    
    messages : bool, default True
        Display messages from CHNOSZ?
        
    Returns
    ----------
    pd.DataFrame
        Pandas dataframe containing a stoichometric matrix of reactions to form
        species from basis species defined by `basis`.
    &#34;&#34;&#34;
    
    args={}
    
    if species != None:
        args[&#34;species&#34;] = _convert_to_RVector(species, force_Rvec=False)
            
    if state != None:
        args[&#34;state&#34;] = _convert_to_RVector(state, force_Rvec=False)
        
    args[&#34;add&#34;] = add
    args[&#34;delete&#34;] = delete
    args[&#34;index.return&#34;] = index_return
    
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        sout = CHNOSZ.species(**args)
        
    if messages:
        for warning in w:
            print(warning.message)
    
    return pandas2ri.ri2py_dataframe(sout)


def basis(species=None, state=None, logact=None, delete=False, messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the basis() function in CHNOSZ.
    Define the basis species of a chemical system.
    
    Parameters
    ----------
    species : str, int, or list of str or int
        Names or formulas of species, or numeric, indices of species.

    state : str or list of str, optional
        Physical states or names of buffers.

    logact : numeric or list of numeric, optional
        Logarithms of activities or fugacities.

    delete : bool, default False
        Delete the current basis species definition?

    messages : bool, default True
        Display messages from CHNOSZ?
        
    Returns
    ----------
    pd.DataFrame
        Pandas dataframe containing a stoichometric matrix of basis species&#39;
        elemental composition.
    &#34;&#34;&#34;
    
    args={}
    
    if species != None:
        args[&#34;species&#34;] = _convert_to_RVector(species, force_Rvec=False)
            
    if state != None:
        args[&#34;state&#34;] = _convert_to_RVector(state, force_Rvec=False)
    
    if logact != None: args[&#34;logact&#34;] = _convert_to_RVector(logact)
    
    args[&#34;delete&#34;] = delete
    
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        bout = CHNOSZ.basis(**args)
        
    if messages:
        for warning in w:
            print(warning.message)
    
    return pandas2ri.ri2py_dataframe(bout)


def reset(messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the reset() function in CHNOSZ.
    Reset all of the data used in CHNOSZ to default values. This includes the
    computational settings, thermodynamic database, and system settings
    (chemical species).
    
    Parameters
    ----------
    messages : bool, default True
        Print messages from CHNOSZ?
    
    &#34;&#34;&#34;
    
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        CHNOSZ.reset()
        
    if messages:
        for warning in w:
            print(warning.message)


def add_OBIGT(file, species=None, force=True, messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the add.OBIGT() function in CHNOSZ.
    Add or overwrite species in the OBIGT thermodynamic database by supplying
    a comma separated value (csv) file with custom data.
    
    Parameters
    ----------
    file : str
        Path to a file.

    species : str, optional
        Names of species to load from file.

    force : bool, default True
        Force replacement of already existing species?
    
    messages : bool, default True
        Print messages from CHNOSZ?
    
    Returns
    ----------
    a : list of int
        A list of OBIGT database indices (ispecies) that have been added or
        modified.
    &#34;&#34;&#34;
    
    args={&#39;file&#39;:file}
    
    if species != None:
        if not isinstance(species, list):
            args[&#34;species&#34;] = species
        else:
            args[&#34;species&#34;] = _convert_to_RVector(species)

    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        ispecies = CHNOSZ.add_OBIGT(**args)
    
    if messages:
        for warning in w:
            print(warning.message)
    
    return list(ispecies)


def mod_OBIGT(*args, messages=True, **kwargs):
    
    &#34;&#34;&#34;
    Python wrapper for the mod.OBIGT() function in CHNOSZ.
    Modify species in the OBIGT thermodynamic database. Optionally, supply a
    Pandas dataframe containing custom data.
    
    Parameters
    ----------
    *args : str, numeric, or Pandas dataframe
        Species names or thermodynamic database index numbers to modify. If a
        Pandas dataframe, database entries to add or modify.
    
    *kwargs : str or numeric
        Properties of species to modify in the thermodynamic database.
    
    messages : bool, default True
        Print messages from CHNOSZ?
    
    Returns
    ----------
    list of int
        A list of OBIGT database indices (ispecies) that have been added or
        modified.
    &#34;&#34;&#34;

    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        
        if isinstance(args[0], pd.DataFrame):
            arg_list = list(args)
            arg_list[0] = pandas2ri.py2ri(arg_list[0])
            args = tuple(arg_list)
        else:
            pass
        
        ispecies = CHNOSZ.mod_OBIGT(*args, **kwargs)
    
    if messages:
        for warning in w:
            print(warning.message)
    
    return list(ispecies)
    
    
def info(species, state=None, check_it=True, messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the info() function in CHNOSZ.
    Search for species by name or formula, retrieve their thermodynamic
    properties and parameters, and add proteins to the thermodynamic database.
    
    Parameters
    ----------
    species : str, int, or list of str or int
        Name or formula of species, or numeric, rownumber of species in the
        OBIGT database.

    state : str or list of str, optional
        State(s) of species.

    check_it : bool, default True
        Check GHS and EOS parameters for self-consistency?
    
    messages : bool, default True
        Print messages from CHNOSZ?
    
    Returns
    ----------
    pd.DataFrame or list of int
        Returns a Pandas dataframe if supplied a list of OBIGT database indices
        (ispecies), or a list of ispecies if given a list of species names or
        formulas.
    &#34;&#34;&#34;
    
    args = {}
    output_is_df = False
    
    args[&#34;species&#34;] = _convert_to_RVector(species, force_Rvec=False)
    if not isinstance(species, list): species = [species]
    if all(isinstance(x, int) for x in species):
        output_is_df = True
    
    if state != None:
        args[&#34;state&#34;] = _convert_to_RVector(state, force_Rvec=False)
    
    args[&#34;check.it&#34;] = check_it

    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        a = CHNOSZ.info(**args)
    
    if messages:
        for warning in w:
            print(warning.message)
    
    if output_is_df:
        return pandas2ri.ri2py_dataframe(a)
    else:
        return list(a)

    
def subcrt(species, coeff=None, state=None,
           property=[&#34;logK&#34;, &#34;G&#34;, &#34;H&#34;, &#34;S&#34;, &#34;V&#34;, &#34;Cp&#34;],
           T=None, P=None, grid=None,
           convert=True, exceed_Ttr=False, exceed_rhomin=False,
           logact=None, autobalance=True, IS=None, messages=True,
           show=True):
    
    &#34;&#34;&#34;
    Python wrapper for the subcrt() function in CHNOSZ.
    Calculate the standard molal thermodynamic properties of one or more
    species or a reaction between species as a function of temperature and
    pressure.
    
    Parameters
    ----------
    species : str, int, or list of str or int
        Name or formula of species, or numeric, rownumber of species in the
        OBIGT database.

    coeff : numeric or list of numeric, optional
        Reaction coefficients on species.

    state : str or list of str, optional
        State(s) of species.

    property : str or list of str, optional
        Property(s) to calculate.

    T : numeric or list of numeric, optional
        Temperature(s) of the calculation.

    P : numeric, list of numeric, or str if &#39;Psat&#39;, default &#39;Psat&#39;
        Pressure(s) of the calculation.

    grid : str, default None
        Type of PxT grid to produce (None, the default, means no gridding).

    exceed_Ttr : bool, default False
        Calculate Gibbs energies of mineral phases and other species beyond
        their transition temperatures?

    exceed_rhomin : bool, default False
        Return properties of species in the HKF model below 0.35 g cm-3?

    logact : numeric or list of numeric, optional
        Logarithms of activities of species in reaction.

    convert : bool, default True
        Are input and output units of T and P those of the user (True) (see
        T_units), or are they Kelvin and bar (False)?

    autobalance : bool, default True
        Attempt to automatically balance reaction with basis species?

    IS : numeric or list of numeric, optional
        Ionic strength(s) at which to calculate adjusted molal properties,
        mol kg^-1.
    
    messages : bool, default True
        Print messages from CHNOSZ?
        
    show : bool, default True
        Display CHNOSZ tables?
    
    Returns
    ----------
    out : object of class SubcrtOutput
        An object that stores the output of `subcrt`.
    &#34;&#34;&#34;
    
    single_species = False
    
    args = {&#39;species&#39;: _convert_to_RVector(species, force_Rvec=False)}
        
    if coeff != None:
        args[&#34;coeff&#34;] = _convert_to_RVector(coeff)
    else:
        single_species = True
        
    if state != None:
        args[&#34;state&#34;] = _convert_to_RVector(state, force_Rvec=False)
    
    args[&#34;property&#34;] = _convert_to_RVector(property)
    
    if T != None:
        args[&#39;T&#39;] = _convert_to_RVector(T, force_Rvec=False)

    if P != None:
        args[&#39;P&#39;] = _convert_to_RVector(P, force_Rvec=False)
    
    if grid != None: args[&#39;grid&#39;] = grid # grid is either &#39;T&#39; or &#39;P&#39;
    
    args[&#39;convert&#39;] = convert
    args[&#39;exceed.Ttr&#39;] = exceed_Ttr
    args[&#39;exceed.rhomin&#39;] = exceed_rhomin
    
    if logact != None: args[&#34;logact&#34;] = _convert_to_RVector(logact)
    
    args[&#39;autobalance&#39;] = autobalance
    
    if IS != None:
        args[&#34;IS&#34;] = _convert_to_RVector(IS, force_Rvec=False)
    
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        a = CHNOSZ.subcrt(**args)
    
    if messages:
        for warning in w:
            print(warning.message)
    
    if len(a) == 3:
        warn = a[2][0] # subcrt&#39;s list includes warnings only if they appear
    else:
        warn = None
    
    if not single_species:
        out_dict = {&#34;reaction&#34;:pandas2ri.ri2py_dataframe(a[0]),
                    &#34;out&#34;:pandas2ri.ri2py_dataframe(a[1])} # the extra [0] is important
    else:
        out_dict = {&#34;species&#34;:pandas2ri.ri2py_dataframe(a[0]), &#34;out&#34;:{}}
        
        i=0
        for df in a[1]:
            out_dict[&#34;out&#34;][out_dict[&#34;species&#34;].name[i]] = pandas2ri.ri2py_dataframe(df)
            i += 1
        
    if warn != None:
        out_dict[&#34;warnings&#34;] = warn
    
    out = SubcrtOutput(out_dict)
    
    if show:
        for table in out.__dict__.keys():
            if not isinstance(out[table], dict):
                display(out[table])
            else:
                for subtable in out[table].keys():
                    print(&#34;\n&#34;+subtable+&#34;:&#34;) # species name
                    display(out[table][subtable])
    
    return out


class SubcrtOutput(object):
    &#34;&#34;&#34;
    Stores the output of a `subcrt` calculation.
    
    Attributes
    ----------
    reaction : pd.DataFrame
        Pandas dataframe summary of the reaction. Only present if a reaction is
        specified.
        
    species : pd.Dataframe
        Pandas dataframe summary of species. Only present if a reaction is not
        specified.
        
    out : pd.Dataframe
        Pandas dataframe of `subcrt` output.
        
    warnings : pd.Dataframe
        Pandas dataframe of calculation warnings. Only present if warnings were
        generated.
        
    &#34;&#34;&#34;
    def __init__(self, args): 
        for k in args:
            setattr(self, k, args[k])

    def __getitem__(self, item):
         return getattr(self, item)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="pyCHNOSZ.fun.add_OBIGT"><code class="name flex">
<span>def <span class="ident">add_OBIGT</span></span>(<span>file, species=None, force=True, messages=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Python wrapper for the add.OBIGT() function in CHNOSZ.
Add or overwrite species in the OBIGT thermodynamic database by supplying
a comma separated value (csv) file with custom data.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>file</code></strong> :&ensp;<code>str</code></dt>
<dd>Path to a file.</dd>
<dt><strong><code>species</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Names of species to load from file.</dd>
<dt><strong><code>force</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Force replacement of already existing species?</dd>
<dt><strong><code>messages</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Print messages from CHNOSZ?</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>a</code></strong> :&ensp;<code>list</code> of <code>int</code></dt>
<dd>A list of OBIGT database indices (ispecies) that have been added or
modified.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_OBIGT(file, species=None, force=True, messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the add.OBIGT() function in CHNOSZ.
    Add or overwrite species in the OBIGT thermodynamic database by supplying
    a comma separated value (csv) file with custom data.
    
    Parameters
    ----------
    file : str
        Path to a file.

    species : str, optional
        Names of species to load from file.

    force : bool, default True
        Force replacement of already existing species?
    
    messages : bool, default True
        Print messages from CHNOSZ?
    
    Returns
    ----------
    a : list of int
        A list of OBIGT database indices (ispecies) that have been added or
        modified.
    &#34;&#34;&#34;
    
    args={&#39;file&#39;:file}
    
    if species != None:
        if not isinstance(species, list):
            args[&#34;species&#34;] = species
        else:
            args[&#34;species&#34;] = _convert_to_RVector(species)

    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        ispecies = CHNOSZ.add_OBIGT(**args)
    
    if messages:
        for warning in w:
            print(warning.message)
    
    return list(ispecies)</code></pre>
</details>
</dd>
<dt id="pyCHNOSZ.fun.affinity"><code class="name flex">
<span>def <span class="ident">affinity</span></span>(<span>property=None, sout=None, exceed_Ttr=False, exceed_rhomin=False, return_buffer=False, return_sout=False, balance='PBB', iprotein=None, loga_protein=-3, transect=None, messages=True, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Python wrapper for the affinity() function in CHNOSZ.
Calculate the chemical affinities of formation reactions of species.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>property</code></strong> :&ensp;<code>str</code>, default <code>'A'</code></dt>
<dd>The property to be calculated. Default is A, for chemical affinity of
formation reactions of species of interest.</dd>
<dt><strong><code>sout</code></strong> :&ensp;<code>list</code></dt>
<dd>Output from <code><a title="pyCHNOSZ.fun.subcrt" href="#pyCHNOSZ.fun.subcrt">subcrt()</a></code>.</dd>
<dt><strong><code>exceed_Ttr</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Allow subcrt to compute properties for phases beyond their transition
temperature?</dd>
<dt><strong><code>exceed_rhomin</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Allow subcrt to compute properties of species in the HKF model below
0.35 g cm-3?</dd>
<dt><strong><code>return_buffer</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>If TRUE, and a buffer has been associated with one or more basis
species in the system, return the values of the activities of the basis
species calculated using the buffer. Default is FALSE.</dd>
<dt><strong><code>return_sout</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Return only the values calculated with subcrt?</dd>
<dt><strong><code>balance</code></strong> :&ensp;<code>str</code>, default <code>'PBB'</code></dt>
<dd>This argument is used to identify a conserved basis species (or PBB) in
a chemical activity buffer.</dd>
<dt><strong><code>iprotein</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Indices of proteins in thermo$protein for which to calculate
properties.</dd>
<dt><strong><code>loga_protein</code></strong> :&ensp;<code>numeric</code>, default <code>-3</code></dt>
<dd>Logarithms of activities of proteins identified in iprotein.</dd>
<dt><strong><code>transect</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Force a transect calculation, even for three or fewer values of the
variables?</dd>
<dt><strong><code>messages</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Display messages from CHNOSZ?</dd>
<dt><strong><code>**kwargs</code></strong> :&ensp;<code>dict</code></dt>
<dd>Numeric, zero or more named arguments, used to identify the variables
of interest in the calculations.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>a</code></strong> :&ensp;<code>rpy2.ListVector</code></dt>
<dd>Output from <code><a title="pyCHNOSZ.fun.affinity" href="#pyCHNOSZ.fun.affinity">affinity()</a></code>.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def affinity(property=None, sout=None, exceed_Ttr=False,
             exceed_rhomin=False, return_buffer=False, return_sout=False,
             balance=&#34;PBB&#34;, iprotein=None, loga_protein=-3, transect=None,
             messages=True, **kwargs):

    &#34;&#34;&#34;
    Python wrapper for the affinity() function in CHNOSZ.
    Calculate the chemical affinities of formation reactions of species.
    
    Parameters
    ----------
    property : str, default &#39;A&#39;
        The property to be calculated. Default is A, for chemical affinity of
        formation reactions of species of interest.

    sout : list
        Output from `subcrt`.

    exceed_Ttr : bool, default False
        Allow subcrt to compute properties for phases beyond their transition
        temperature?

    exceed_rhomin : bool, default False
        Allow subcrt to compute properties of species in the HKF model below
        0.35 g cm-3?

    return_buffer : bool, default False
        If TRUE, and a buffer has been associated with one or more basis
        species in the system, return the values of the activities of the basis
        species calculated using the buffer. Default is FALSE.

    return_sout : bool, default False
        Return only the values calculated with subcrt?

    balance : str, default &#39;PBB&#39;
        This argument is used to identify a conserved basis species (or PBB) in
        a chemical activity buffer.

    iprotein : numeric, optional
        Indices of proteins in thermo$protein for which to calculate
        properties.

    loga_protein : numeric, default -3
        Logarithms of activities of proteins identified in iprotein.

    transect : bool, optional
        Force a transect calculation, even for three or fewer values of the
        variables?
    
    messages : bool, default True
        Display messages from CHNOSZ?
        
    **kwargs : dict
        Numeric, zero or more named arguments, used to identify the variables
        of interest in the calculations.
    
    Returns
    -------
    a : rpy2.ListVector
        Output from `affinity`.
    &#34;&#34;&#34;
    
    args = {&#39;exceed_Ttr&#39;:exceed_Ttr, &#39;exceed_rhomin&#39;:exceed_rhomin,
            &#39;return_buffer&#39;:return_buffer, &#39;return_sout&#39;:return_sout,
            &#39;balance&#39;:balance, &#39;loga_protein&#39;:loga_protein}
    
    if property != None: args[&#34;property&#34;] = property
    if sout != None: args[&#34;sout&#34;] = sout
    if iprotein != None: args[&#34;iprotein&#34;] = iprotein
    if transect != None: args[&#34;transect&#34;] = transect
    
    for key, value in kwargs.items():
        if isinstance(value, list):
            value = ro.FloatVector(value)
        args.update({key:value})
        
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        a = CHNOSZ.affinity(**args)

    if messages:
        for warning in w:
            print(warning.message)

    return a</code></pre>
</details>
</dd>
<dt id="pyCHNOSZ.fun.basis"><code class="name flex">
<span>def <span class="ident">basis</span></span>(<span>species=None, state=None, logact=None, delete=False, messages=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Python wrapper for the basis() function in CHNOSZ.
Define the basis species of a chemical system.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>species</code></strong> :&ensp;<code>str, int,</code> or <code>list</code> of <code>str</code> or <code>int</code></dt>
<dd>Names or formulas of species, or numeric, indices of species.</dd>
<dt><strong><code>state</code></strong> :&ensp;<code>str</code> or <code>list</code> of <code>str</code>, optional</dt>
<dd>Physical states or names of buffers.</dd>
<dt><strong><code>logact</code></strong> :&ensp;<code>numeric</code> or <code>list</code> of <code>numeric</code>, optional</dt>
<dd>Logarithms of activities or fugacities.</dd>
<dt><strong><code>delete</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Delete the current basis species definition?</dd>
<dt><strong><code>messages</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Display messages from CHNOSZ?</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.DataFrame</code></dt>
<dd>Pandas dataframe containing a stoichometric matrix of basis species'
elemental composition.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def basis(species=None, state=None, logact=None, delete=False, messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the basis() function in CHNOSZ.
    Define the basis species of a chemical system.
    
    Parameters
    ----------
    species : str, int, or list of str or int
        Names or formulas of species, or numeric, indices of species.

    state : str or list of str, optional
        Physical states or names of buffers.

    logact : numeric or list of numeric, optional
        Logarithms of activities or fugacities.

    delete : bool, default False
        Delete the current basis species definition?

    messages : bool, default True
        Display messages from CHNOSZ?
        
    Returns
    ----------
    pd.DataFrame
        Pandas dataframe containing a stoichometric matrix of basis species&#39;
        elemental composition.
    &#34;&#34;&#34;
    
    args={}
    
    if species != None:
        args[&#34;species&#34;] = _convert_to_RVector(species, force_Rvec=False)
            
    if state != None:
        args[&#34;state&#34;] = _convert_to_RVector(state, force_Rvec=False)
    
    if logact != None: args[&#34;logact&#34;] = _convert_to_RVector(logact)
    
    args[&#34;delete&#34;] = delete
    
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        bout = CHNOSZ.basis(**args)
        
    if messages:
        for warning in w:
            print(warning.message)
    
    return pandas2ri.ri2py_dataframe(bout)</code></pre>
</details>
</dd>
<dt id="pyCHNOSZ.fun.diagram"><code class="name flex">
<span>def <span class="ident">diagram</span></span>(<span>eout, ptype='auto', alpha=False, normalize=False, as_residue=False, balance=None, groups=None, xrange=None, mar=None, yline=None, side=[1, 2, 3, 4], ylog=True, xlim=None, ylim=None, xlab=None, ylab=None, cex=None, cex_names=None, cex_axis=None, lty=None, lwd=None, dotted=None, spline_method=None, contour_method=None, levels=None, col=None, col_names=None, fill=None, fill_NA='gray80', limit_water=None, names=None, format_names=True, bold=False, italic=False, font=None, family=None, adj=0.5, dx=0, dy=0, srt=0, min_area=0, main=None, legend_x=None, add=False, plot_it=True, tplot=True, messages=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Python wrapper for the diagram() function in CHNOSZ.
Plot equilibrium chemical activity (1-D speciation) or equal-activity
(2-D predominance) diagrams as a function of chemical activities of
basis species, temperature and/or pressure.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>eout</code></strong> :&ensp;<code>rpy2.ListVector</code></dt>
<dd>Output from <code><a title="pyCHNOSZ.fun.equilibrate" href="#pyCHNOSZ.fun.equilibrate">equilibrate()</a></code> or <code><a title="pyCHNOSZ.fun.affinity" href="#pyCHNOSZ.fun.affinity">affinity()</a></code>.</dd>
<dt><strong><code>ptype</code></strong> :&ensp;<code>str</code>, default <code>'auto'</code></dt>
<dd>Type of plot, or name of basis species whose activity to plot.</dd>
<dt><strong><code>alpha</code></strong> :&ensp;<code>bool</code> or <code>str (balance)</code>, default <code>False</code></dt>
<dd>For speciation diagrams, plot degree of formation instead of
activities?</dd>
<dt><strong><code>normalize</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Divide chemical affinities by balance coefficients (rescale to whole
formulas)?</dd>
<dt><strong><code>as_residue</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Divide chemical affinities by balance coefficients (no rescaling)?</dd>
<dt><strong><code>balance</code></strong> :&ensp;<code>str</code> or <code>numeric</code>, optional</dt>
<dd>How to balance the transformations.</dd>
<dt><strong><code>groups</code></strong> :&ensp;<code>rpy2.ListVector</code> of <code>numeric</code>, optional</dt>
<dd>Groups of species to consider as a single effective species.</dd>
<dt><strong><code>xrange</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Range of x-values between which predominance field boundaries are
plotted.</dd>
<dt><strong><code>mar</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Margins of plot frame.</dd>
<dt><strong><code>yline</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Margin line on which to plot the y-axis name.</dd>
<dt><strong><code>side</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Which sides of plot to draw axes.</dd>
<dt><strong><code>xlim</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Limits of x-axis.</dd>
<dt><strong><code>ylim</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Limits of y-axis.</dd>
<dt><strong><code>xlab</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Label to use for x-axis.</dd>
<dt><strong><code>ylab</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Label to use for y-axis.</dd>
<dt><strong><code>ylog</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Use a logarithmic y-axis (on 1D degree diagrams)?</dd>
<dt><strong><code>cex</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Character expansion (scaling relative to current).</dd>
<dt><strong><code>cex_names</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Character expansion factor to be used for names of species on plots.</dd>
<dt><strong><code>cex_axis</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Character expansion factor for names of axes.</dd>
<dt><strong><code>lty</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Line types to be used in plots.</dd>
<dt><strong><code>lwd</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Line width.</dd>
<dt><strong><code>dotted</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>How often to skip plotting points on predominance field boundaries (to
gain the effect of dotted or dashed boundary lines).</dd>
<dt><strong><code>spline_method</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Method used in splinefun.</dd>
<dt><strong><code>contour_method</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Labelling method used in contour (use NULL for no labels).</dd>
<dt><strong><code>levels</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Levels at which to draw contour lines.</dd>
<dt><strong><code>col</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Color of activity lines (1D diagram) or predominance field boundaries
(2D diagram).</dd>
<dt><strong><code>col_names</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Colors for labels of species.</dd>
<dt><strong><code>fill</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Colors used to fill predominance fields.</dd>
<dt><strong><code>fill_NA</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Color for grid points with NA values.</dd>
<dt><strong><code>limit_water</code></strong> :&ensp;<code>None</code> or <code>bool</code>, optional</dt>
<dd>Set NaN values beyond water stability limits?</dd>
<dt><strong><code>names</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Names of species for activity lines or predominance fields.</dd>
<dt><strong><code>format_names</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Apply formatting to chemical formulas?</dd>
<dt><strong><code>bold</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Use bold formatting for names?</dd>
<dt><strong><code>italic</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Use italic formatting for names?</dd>
<dt><strong><code>font</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Font type for names (has no effect if format.names is TRUE).</dd>
<dt><strong><code>family</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Font family for names.</dd>
<dt><strong><code>adj</code></strong> :&ensp;<code>numeric</code>, default <code>0.5</code></dt>
<dd>Adjustment for line labels.</dd>
<dt><strong><code>dx</code></strong> :&ensp;<code>numeric</code>, default <code>0</code></dt>
<dd>X offset for line or field labels.</dd>
<dt><strong><code>dy</code></strong> :&ensp;<code>numeric</code>, default <code>0</code></dt>
<dd>Y offset for line or field labels.</dd>
<dt><strong><code>srt</code></strong> :&ensp;<code>numeric</code>, default <code>0</code></dt>
<dd>Rotation for line labels.</dd>
<dt><strong><code>min_area</code></strong> :&ensp;<code>numeric</code>, default <code>0</code></dt>
<dd>Minimum area of fields that should be labeled, expressed as a fraction
of the total plot area.</dd>
<dt><strong><code>main</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>A main title for the plot; NULL means to plot no title.</dd>
<dt><strong><code>legend_x</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Description of legend placement passed to legend.</dd>
<dt><strong><code>add</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Add to current plot?</dd>
<dt><strong><code>plot_it</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Make a plot?</dd>
<dt><strong><code>tplot</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Set up plot with thermo.plot.new?</dd>
<dt><strong><code>messages</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Display messages from CHNOSZ?</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>a</code></strong> :&ensp;<code>rpy2.ListVector</code></dt>
<dd>Output from <code><a title="pyCHNOSZ.fun.diagram" href="#pyCHNOSZ.fun.diagram">diagram()</a></code>.</dd>
<dt><strong><code>args</code></strong> :&ensp;<code>dict</code></dt>
<dd>Dictionary of arguments supplied to <code><a title="pyCHNOSZ.fun.diagram" href="#pyCHNOSZ.fun.diagram">diagram()</a></code>.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def diagram(eout, ptype=&#39;auto&#39;, alpha=False, normalize=False,
            as_residue=False, balance=None, groups=None,
            xrange=None, mar=None, yline=None, side=[1,2,3,4],
            ylog=True, xlim=None, ylim=None, xlab=None, ylab=None,
            cex=None, cex_names=None, cex_axis=None,
            lty=None, lwd=None, dotted=None,
            spline_method=None, contour_method=None, levels=None,
            col=None, col_names=None, fill=None,
            fill_NA=&#34;gray80&#34;, limit_water=None,
            names=None, format_names=True, bold=False, italic=False, 
            font=None, family=None, adj=0.5,
            dx=0, dy=0, srt=0, min_area=0,
            main=None, legend_x=None,
            add=False, plot_it=True, tplot=True,
            messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the diagram() function in CHNOSZ.
    Plot equilibrium chemical activity (1-D speciation) or equal-activity
    (2-D predominance) diagrams as a function of chemical activities of
    basis species, temperature and/or pressure.
    
    Parameters
    ----------
    eout : rpy2.ListVector
        Output from `equilibrate` or `affinity`.
    
    ptype : str, default &#39;auto&#39;
        Type of plot, or name of basis species whose activity to plot.

    alpha : bool or str (balance), default False
        For speciation diagrams, plot degree of formation instead of
        activities?

    normalize : bool, default False
        Divide chemical affinities by balance coefficients (rescale to whole
        formulas)?

    as_residue : bool, default False
        Divide chemical affinities by balance coefficients (no rescaling)?

    balance : str or numeric, optional
        How to balance the transformations.

    groups : rpy2.ListVector of numeric, optional
        Groups of species to consider as a single effective species.

    xrange : numeric, optional
        Range of x-values between which predominance field boundaries are
        plotted.

    mar : numeric, optional
        Margins of plot frame.

    yline : numeric, optional
        Margin line on which to plot the y-axis name.

    side : numeric, optional
        Which sides of plot to draw axes.

    xlim : numeric, optional
        Limits of x-axis.

    ylim : numeric, optional
        Limits of y-axis.

    xlab : str, optional
        Label to use for x-axis.

    ylab : str, optional
        Label to use for y-axis.

    ylog : bool, optional
        Use a logarithmic y-axis (on 1D degree diagrams)?

    cex : numeric, optional
        Character expansion (scaling relative to current).

    cex_names : numeric, optional
        Character expansion factor to be used for names of species on plots.

    cex_axis : numeric, optional
        Character expansion factor for names of axes.

    lty : numeric, optional
        Line types to be used in plots.

    lwd : numeric, optional
        Line width.

    dotted : numeric, optional
        How often to skip plotting points on predominance field boundaries (to
        gain the effect of dotted or dashed boundary lines).

    spline_method : str, optional
        Method used in splinefun.

    contour_method : str, optional
        Labelling method used in contour (use NULL for no labels).

    levels : numeric, optional
        Levels at which to draw contour lines.

    col : str, optional
        Color of activity lines (1D diagram) or predominance field boundaries
        (2D diagram).

    col_names : str, optional
        Colors for labels of species.

    fill : str, optional
        Colors used to fill predominance fields.

    fill_NA : str, optional
        Color for grid points with NA values.

    limit_water : None or bool, optional
        Set NaN values beyond water stability limits?

    names : str, optional
        Names of species for activity lines or predominance fields.

    format_names : bool, default True
        Apply formatting to chemical formulas?

    bold : bool, default False
        Use bold formatting for names?

    italic : bool, default False
        Use italic formatting for names?

    font : str, optional
        Font type for names (has no effect if format.names is TRUE).

    family : str, optional
        Font family for names.

    adj : numeric, default 0.5
        Adjustment for line labels.

    dx : numeric, default 0
        X offset for line or field labels.

    dy : numeric, default 0
        Y offset for line or field labels.

    srt : numeric, default 0
        Rotation for line labels.

    min_area : numeric, default 0
        Minimum area of fields that should be labeled, expressed as a fraction
        of the total plot area.

    main : str, optional
        A main title for the plot; NULL means to plot no title.

    legend_x : str, optional
        Description of legend placement passed to legend.

    add : bool, default False
        Add to current plot?

    plot_it : bool, default True
        Make a plot?

    tplot : bool, default True
        Set up plot with thermo.plot.new?
    
    messages : bool, default True
        Display messages from CHNOSZ?
    
    Returns
    -------
    a : rpy2.ListVector
        Output from `diagram`.
    args : dict
        Dictionary of arguments supplied to `diagram`.
    &#34;&#34;&#34;
    
    args = {&#39;eout&#39;:eout, &#39;ptype&#39;:ptype, &#39;alpha&#39;:alpha, &#39;normalize&#39;:normalize,
            &#39;as.residue&#39;:as_residue, &#39;ylog&#39;:ylog, &#39;fill.NA&#39;:fill_NA, &#39;format.names&#39;:format_names,
            &#39;bold&#39;:bold, &#39;italic&#39;:italic, &#39;adj&#39;:adj, &#39;dx&#39;:dx, &#39;dy&#39;:dy, &#39;srt&#39;:srt,
            &#39;min.area&#39;:min_area, &#39;plot.it&#39;:plot_it, &#39;tplot&#39;:tplot}
    
    if balance != None: args[&#34;balance&#34;] = balance
    if groups != None: args[&#34;groups&#34;] = groups
    if xrange != None: args[&#34;xrange&#34;] = _convert_to_RVector(xrange)
    if mar != None: args[&#34;mar&#34;] = _convert_to_RVector(mar)
    if yline != None: args[&#34;yline&#34;] = _convert_to_RVector(yline)
    if side != None: args[&#34;side&#34;] = _convert_to_RVector(side)
    if xlim != None: args[&#34;xlim&#34;] = _convert_to_RVector(xlim)
    if ylim != None: args[&#34;ylim&#34;] = _convert_to_RVector(ylim)
    if xlab != None: args[&#34;xlab&#34;] = xlab
    if ylab != None: args[&#34;ylab&#34;] = ylab
    if cex != None: args[&#34;cex&#34;] = _convert_to_RVector(cex)
    if cex_names != None: args[&#34;cex.names&#34;] = _convert_to_RVector(cex_names)
    if cex_axis != None: args[&#34;cex.axis&#34;] = _convert_to_RVector(cex_axis)
    if lty != None: args[&#34;lty&#34;] = _convert_to_RVector(lty)
    if lwd != None: args[&#34;lwd&#34;] = _convert_to_RVector(lwd)
    if dotted != None: args[&#34;dotted&#34;] = convert_to_RVector(dotted)
    if spline_method != None: args[&#34;spline.method&#34;] = spline_method
    if contour_method != None: args[&#34;contour.method&#34;] = contour_method
    if levels != None: args[&#34;levels&#34;] = _convert_to_RVector(levels)
    if col != None: args[&#34;col&#34;] = _convert_to_RVector(col)
    if col_names != None: args[&#34;col.names&#34;] = _convert_to_RVector(col_names)
    if fill != None: args[&#34;fill&#34;] = _convert_to_RVector(fill)
    if limit_water != None: args[&#34;limit.water&#34;] = limit_water
    if names != None: args[&#34;names&#34;] = _convert_to_RVector(names)
    if font != None: args[&#34;font&#34;] = _convert_to_RVector(font)
    if family != None: args[&#34;family&#34;] = _convert_to_RVector(family)
    if main != None: args[&#34;main&#34;] = main
    if legend_x != None: args[&#34;legend.x&#34;] = legend_x
    
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        with __r_inline_plot(width=1024, height=896, dpi=150):
            if isinstance(add, bool):
                if add: # add=&#39;True&#39; does not work with the current pyCHNOSZ framework
                    raise Exception(&#34;The argument &#39;add&#39; must be assigned the output of the previous diagram(s).&#34;)
                else:
                    a = CHNOSZ.diagram(**args)
            elif isinstance(add, list):
                args.update({&#39;add&#39;:True})
                for to_add in add:
                    CHNOSZ.diagram(**to_add)
                a = CHNOSZ.diagram(**args)
                    
            else:
                CHNOSZ.diagram(**add)
                args.update({&#39;add&#39;:True})
                a = CHNOSZ.diagram(**args)
            
    if messages:
        for warning in w:
            print(warning.message)
    
    return a, args</code></pre>
</details>
</dd>
<dt id="pyCHNOSZ.fun.equilibrate"><code class="name flex">
<span>def <span class="ident">equilibrate</span></span>(<span>aout, balance=None, loga_balance=None, ispecies=None, normalize=False, messages=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Python wrapper for the equilibrate() function in CHNOSZ.
Calculate equilibrium chemical activities of species from the affinities
of formation of the species at unit activity.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>aout</code></strong> :&ensp;<code>rpy2.ListVector</code></dt>
<dd>Output from <code><a title="pyCHNOSZ.fun.affinity" href="#pyCHNOSZ.fun.affinity">affinity()</a></code>.</dd>
<dt><strong><code>balance</code></strong> :&ensp;<code>str</code> or <code>numeric</code>, optional</dt>
<dd>How to balance the transformations.</dd>
<dt><strong><code>loga_balance</code></strong> :&ensp;<code>numeric</code> or <code>list</code> of <code>numeric</code>, optional</dt>
<dd>Logarithm of total activity of balanced quantity.</dd>
<dt><strong><code>ispecies</code></strong> :&ensp;<code>numeric</code>, optional</dt>
<dd>Which species to include.</dd>
<dt><strong><code>normalize</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Normalize the molar formulas of species by the balancing coefficients?</dd>
<dt><strong><code>messages</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Display messages from CHNOSZ?</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>eout</code></strong> :&ensp;<code>rpy2.ListVector</code></dt>
<dd>Output from <code><a title="pyCHNOSZ.fun.equilibrate" href="#pyCHNOSZ.fun.equilibrate">equilibrate()</a></code>.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def equilibrate(aout, balance=None, loga_balance=None, ispecies=None,
                normalize=False, messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the equilibrate() function in CHNOSZ.
    Calculate equilibrium chemical activities of species from the affinities
    of formation of the species at unit activity.
    
    Parameters
    ----------
    aout : rpy2.ListVector
        Output from `affinity`.
    
    balance : str or numeric, optional
        How to balance the transformations.
    
    loga_balance : numeric or list of numeric, optional
        Logarithm of total activity of balanced quantity.
    
    ispecies : numeric, optional
        Which species to include.
    
    normalize : bool, default False
        Normalize the molar formulas of species by the balancing coefficients?
    
    messages : bool, default True
        Display messages from CHNOSZ?
    
    Returns
    -------
    eout : rpy2.ListVector
        Output from `equilibrate`.
    &#34;&#34;&#34;
        
    # stay.normal is an unused argument in equilibrate()?
    
    args = {&#39;aout&#39;:aout, &#39;normalize&#39;:normalize}
    
    if balance != None: args[&#39;balance&#39;] = balance
    if loga_balance != None: args[&#39;loga.balance&#39;] = loga_balance
    if ispecies != None: args[&#39;ispecies&#39;] = _convert_to_RVector(ispecies)

    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        eout = CHNOSZ.equilibrate(**args)

    if messages:
        for warning in w:
            print(warning.message)
    
    return eout</code></pre>
</details>
</dd>
<dt id="pyCHNOSZ.fun.info"><code class="name flex">
<span>def <span class="ident">info</span></span>(<span>species, state=None, check_it=True, messages=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Python wrapper for the info() function in CHNOSZ.
Search for species by name or formula, retrieve their thermodynamic
properties and parameters, and add proteins to the thermodynamic database.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>species</code></strong> :&ensp;<code>str, int,</code> or <code>list</code> of <code>str</code> or <code>int</code></dt>
<dd>Name or formula of species, or numeric, rownumber of species in the
OBIGT database.</dd>
<dt><strong><code>state</code></strong> :&ensp;<code>str</code> or <code>list</code> of <code>str</code>, optional</dt>
<dd>State(s) of species.</dd>
<dt><strong><code>check_it</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Check GHS and EOS parameters for self-consistency?</dd>
<dt><strong><code>messages</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Print messages from CHNOSZ?</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.DataFrame</code> or <code>list</code> of <code>int</code></dt>
<dd>Returns a Pandas dataframe if supplied a list of OBIGT database indices
(ispecies), or a list of ispecies if given a list of species names or
formulas.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def info(species, state=None, check_it=True, messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the info() function in CHNOSZ.
    Search for species by name or formula, retrieve their thermodynamic
    properties and parameters, and add proteins to the thermodynamic database.
    
    Parameters
    ----------
    species : str, int, or list of str or int
        Name or formula of species, or numeric, rownumber of species in the
        OBIGT database.

    state : str or list of str, optional
        State(s) of species.

    check_it : bool, default True
        Check GHS and EOS parameters for self-consistency?
    
    messages : bool, default True
        Print messages from CHNOSZ?
    
    Returns
    ----------
    pd.DataFrame or list of int
        Returns a Pandas dataframe if supplied a list of OBIGT database indices
        (ispecies), or a list of ispecies if given a list of species names or
        formulas.
    &#34;&#34;&#34;
    
    args = {}
    output_is_df = False
    
    args[&#34;species&#34;] = _convert_to_RVector(species, force_Rvec=False)
    if not isinstance(species, list): species = [species]
    if all(isinstance(x, int) for x in species):
        output_is_df = True
    
    if state != None:
        args[&#34;state&#34;] = _convert_to_RVector(state, force_Rvec=False)
    
    args[&#34;check.it&#34;] = check_it

    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        a = CHNOSZ.info(**args)
    
    if messages:
        for warning in w:
            print(warning.message)
    
    if output_is_df:
        return pandas2ri.ri2py_dataframe(a)
    else:
        return list(a)</code></pre>
</details>
</dd>
<dt id="pyCHNOSZ.fun.mod_OBIGT"><code class="name flex">
<span>def <span class="ident">mod_OBIGT</span></span>(<span>*args, messages=True, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Python wrapper for the mod.OBIGT() function in CHNOSZ.
Modify species in the OBIGT thermodynamic database. Optionally, supply a
Pandas dataframe containing custom data.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>*args</code></strong> :&ensp;<code>str, numeric,</code> or <code>Pandas dataframe</code></dt>
<dd>Species names or thermodynamic database index numbers to modify. If a
Pandas dataframe, database entries to add or modify.</dd>
<dt><strong><code>*kwargs</code></strong> :&ensp;<code>str</code> or <code>numeric</code></dt>
<dd>Properties of species to modify in the thermodynamic database.</dd>
<dt><strong><code>messages</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Print messages from CHNOSZ?</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code> of <code>int</code></dt>
<dd>A list of OBIGT database indices (ispecies) that have been added or
modified.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def mod_OBIGT(*args, messages=True, **kwargs):
    
    &#34;&#34;&#34;
    Python wrapper for the mod.OBIGT() function in CHNOSZ.
    Modify species in the OBIGT thermodynamic database. Optionally, supply a
    Pandas dataframe containing custom data.
    
    Parameters
    ----------
    *args : str, numeric, or Pandas dataframe
        Species names or thermodynamic database index numbers to modify. If a
        Pandas dataframe, database entries to add or modify.
    
    *kwargs : str or numeric
        Properties of species to modify in the thermodynamic database.
    
    messages : bool, default True
        Print messages from CHNOSZ?
    
    Returns
    ----------
    list of int
        A list of OBIGT database indices (ispecies) that have been added or
        modified.
    &#34;&#34;&#34;

    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        
        if isinstance(args[0], pd.DataFrame):
            arg_list = list(args)
            arg_list[0] = pandas2ri.py2ri(arg_list[0])
            args = tuple(arg_list)
        else:
            pass
        
        ispecies = CHNOSZ.mod_OBIGT(*args, **kwargs)
    
    if messages:
        for warning in w:
            print(warning.message)
    
    return list(ispecies)</code></pre>
</details>
</dd>
<dt id="pyCHNOSZ.fun.reset"><code class="name flex">
<span>def <span class="ident">reset</span></span>(<span>messages=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Python wrapper for the reset() function in CHNOSZ.
Reset all of the data used in CHNOSZ to default values. This includes the
computational settings, thermodynamic database, and system settings
(chemical species).</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>messages</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Print messages from CHNOSZ?</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def reset(messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the reset() function in CHNOSZ.
    Reset all of the data used in CHNOSZ to default values. This includes the
    computational settings, thermodynamic database, and system settings
    (chemical species).
    
    Parameters
    ----------
    messages : bool, default True
        Print messages from CHNOSZ?
    
    &#34;&#34;&#34;
    
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        CHNOSZ.reset()
        
    if messages:
        for warning in w:
            print(warning.message)</code></pre>
</details>
</dd>
<dt id="pyCHNOSZ.fun.species"><code class="name flex">
<span>def <span class="ident">species</span></span>(<span>species=None, state=None, delete=False, add=False, index_return=False, messages=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Python wrapper for the species() function in CHNOSZ.
Define the species of interest in a system; modify their physical states
and logarithms of activities.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>species</code></strong> :&ensp;<code>str, int,</code> or <code>list</code> of <code>str</code> or <code>int</code></dt>
<dd>Names or formulas of species to add to the species definition; int,
rownumbers of species to modify or delete.</dd>
<dt><strong><code>state</code></strong> :&ensp;<code>str</code> or <code>list</code> of <code>str</code>, optional</dt>
<dd>physical states; numeric, logarithms of activities or fugacities.</dd>
<dt><strong><code>delete</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Delete the species identified by numeric values of species (or all
species if that argument is missing)?</dd>
<dt><strong><code>add</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Delete a previous species definition instead of adding to it?</dd>
<dt><strong><code>index_return</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>return the affected rownumbers of species in the OBIGT database instead
of the normal output of <code><a title="pyCHNOSZ.fun.species" href="#pyCHNOSZ.fun.species">species()</a></code>?</dd>
<dt><strong><code>messages</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Display messages from CHNOSZ?</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>pd.DataFrame</code></dt>
<dd>Pandas dataframe containing a stoichometric matrix of reactions to form
species from basis species defined by <code><a title="pyCHNOSZ.fun.basis" href="#pyCHNOSZ.fun.basis">basis()</a></code>.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def species(species=None, state=None, delete=False, add=False,
            index_return=False, messages=True):
    
    &#34;&#34;&#34;
    Python wrapper for the species() function in CHNOSZ.
    Define the species of interest in a system; modify their physical states
    and logarithms of activities.
    
    Parameters
    ----------
    species : str, int, or list of str or int
        Names or formulas of species to add to the species definition; int,
        rownumbers of species to modify or delete.

    state : str or list of str, optional
        physical states; numeric, logarithms of activities or fugacities.

    delete : bool, default False
        Delete the species identified by numeric values of species (or all
        species if that argument is missing)?

    add : bool, default False
        Delete a previous species definition instead of adding to it?

    index_return : bool, default False
        return the affected rownumbers of species in the OBIGT database instead
        of the normal output of `species`?
    
    messages : bool, default True
        Display messages from CHNOSZ?
        
    Returns
    ----------
    pd.DataFrame
        Pandas dataframe containing a stoichometric matrix of reactions to form
        species from basis species defined by `basis`.
    &#34;&#34;&#34;
    
    args={}
    
    if species != None:
        args[&#34;species&#34;] = _convert_to_RVector(species, force_Rvec=False)
            
    if state != None:
        args[&#34;state&#34;] = _convert_to_RVector(state, force_Rvec=False)
        
    args[&#34;add&#34;] = add
    args[&#34;delete&#34;] = delete
    args[&#34;index.return&#34;] = index_return
    
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        sout = CHNOSZ.species(**args)
        
    if messages:
        for warning in w:
            print(warning.message)
    
    return pandas2ri.ri2py_dataframe(sout)</code></pre>
</details>
</dd>
<dt id="pyCHNOSZ.fun.subcrt"><code class="name flex">
<span>def <span class="ident">subcrt</span></span>(<span>species, coeff=None, state=None, property=['logK', 'G', 'H', 'S', 'V', 'Cp'], T=None, P=None, grid=None, convert=True, exceed_Ttr=False, exceed_rhomin=False, logact=None, autobalance=True, IS=None, messages=True, show=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Python wrapper for the subcrt() function in CHNOSZ.
Calculate the standard molal thermodynamic properties of one or more
species or a reaction between species as a function of temperature and
pressure.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>species</code></strong> :&ensp;<code>str, int,</code> or <code>list</code> of <code>str</code> or <code>int</code></dt>
<dd>Name or formula of species, or numeric, rownumber of species in the
OBIGT database.</dd>
<dt><strong><code>coeff</code></strong> :&ensp;<code>numeric</code> or <code>list</code> of <code>numeric</code>, optional</dt>
<dd>Reaction coefficients on species.</dd>
<dt><strong><code>state</code></strong> :&ensp;<code>str</code> or <code>list</code> of <code>str</code>, optional</dt>
<dd>State(s) of species.</dd>
<dt><strong><code>property</code></strong> :&ensp;<code>str</code> or <code>list</code> of <code>str</code>, optional</dt>
<dd>Property(s) to calculate.</dd>
<dt><strong><code>T</code></strong> :&ensp;<code>numeric</code> or <code>list</code> of <code>numeric</code>, optional</dt>
<dd>Temperature(s) of the calculation.</dd>
<dt><strong><code>P</code></strong> :&ensp;<code>numeric, list</code> of <code>numeric,</code> or <code>str if 'Psat'</code>, default <code>'Psat'</code></dt>
<dd>Pressure(s) of the calculation.</dd>
<dt><strong><code>grid</code></strong> :&ensp;<code>str</code>, default <code>None</code></dt>
<dd>Type of PxT grid to produce (None, the default, means no gridding).</dd>
<dt><strong><code>exceed_Ttr</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Calculate Gibbs energies of mineral phases and other species beyond
their transition temperatures?</dd>
<dt><strong><code>exceed_rhomin</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt>
<dd>Return properties of species in the HKF model below 0.35 g cm-3?</dd>
<dt><strong><code>logact</code></strong> :&ensp;<code>numeric</code> or <code>list</code> of <code>numeric</code>, optional</dt>
<dd>Logarithms of activities of species in reaction.</dd>
<dt><strong><code>convert</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Are input and output units of T and P those of the user (True) (see
T_units), or are they Kelvin and bar (False)?</dd>
<dt><strong><code>autobalance</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Attempt to automatically balance reaction with basis species?</dd>
<dt><strong><code>IS</code></strong> :&ensp;<code>numeric</code> or <code>list</code> of <code>numeric</code>, optional</dt>
<dd>Ionic strength(s) at which to calculate adjusted molal properties,
mol kg^-1.</dd>
<dt><strong><code>messages</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Print messages from CHNOSZ?</dd>
<dt><strong><code>show</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt>
<dd>Display CHNOSZ tables?</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>out</code></strong> :&ensp;<code>object</code> of <code>class <a title="pyCHNOSZ.fun.SubcrtOutput" href="#pyCHNOSZ.fun.SubcrtOutput">SubcrtOutput</a></code></dt>
<dd>An object that stores the output of <code><a title="pyCHNOSZ.fun.subcrt" href="#pyCHNOSZ.fun.subcrt">subcrt()</a></code>.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def subcrt(species, coeff=None, state=None,
           property=[&#34;logK&#34;, &#34;G&#34;, &#34;H&#34;, &#34;S&#34;, &#34;V&#34;, &#34;Cp&#34;],
           T=None, P=None, grid=None,
           convert=True, exceed_Ttr=False, exceed_rhomin=False,
           logact=None, autobalance=True, IS=None, messages=True,
           show=True):
    
    &#34;&#34;&#34;
    Python wrapper for the subcrt() function in CHNOSZ.
    Calculate the standard molal thermodynamic properties of one or more
    species or a reaction between species as a function of temperature and
    pressure.
    
    Parameters
    ----------
    species : str, int, or list of str or int
        Name or formula of species, or numeric, rownumber of species in the
        OBIGT database.

    coeff : numeric or list of numeric, optional
        Reaction coefficients on species.

    state : str or list of str, optional
        State(s) of species.

    property : str or list of str, optional
        Property(s) to calculate.

    T : numeric or list of numeric, optional
        Temperature(s) of the calculation.

    P : numeric, list of numeric, or str if &#39;Psat&#39;, default &#39;Psat&#39;
        Pressure(s) of the calculation.

    grid : str, default None
        Type of PxT grid to produce (None, the default, means no gridding).

    exceed_Ttr : bool, default False
        Calculate Gibbs energies of mineral phases and other species beyond
        their transition temperatures?

    exceed_rhomin : bool, default False
        Return properties of species in the HKF model below 0.35 g cm-3?

    logact : numeric or list of numeric, optional
        Logarithms of activities of species in reaction.

    convert : bool, default True
        Are input and output units of T and P those of the user (True) (see
        T_units), or are they Kelvin and bar (False)?

    autobalance : bool, default True
        Attempt to automatically balance reaction with basis species?

    IS : numeric or list of numeric, optional
        Ionic strength(s) at which to calculate adjusted molal properties,
        mol kg^-1.
    
    messages : bool, default True
        Print messages from CHNOSZ?
        
    show : bool, default True
        Display CHNOSZ tables?
    
    Returns
    ----------
    out : object of class SubcrtOutput
        An object that stores the output of `subcrt`.
    &#34;&#34;&#34;
    
    single_species = False
    
    args = {&#39;species&#39;: _convert_to_RVector(species, force_Rvec=False)}
        
    if coeff != None:
        args[&#34;coeff&#34;] = _convert_to_RVector(coeff)
    else:
        single_species = True
        
    if state != None:
        args[&#34;state&#34;] = _convert_to_RVector(state, force_Rvec=False)
    
    args[&#34;property&#34;] = _convert_to_RVector(property)
    
    if T != None:
        args[&#39;T&#39;] = _convert_to_RVector(T, force_Rvec=False)

    if P != None:
        args[&#39;P&#39;] = _convert_to_RVector(P, force_Rvec=False)
    
    if grid != None: args[&#39;grid&#39;] = grid # grid is either &#39;T&#39; or &#39;P&#39;
    
    args[&#39;convert&#39;] = convert
    args[&#39;exceed.Ttr&#39;] = exceed_Ttr
    args[&#39;exceed.rhomin&#39;] = exceed_rhomin
    
    if logact != None: args[&#34;logact&#34;] = _convert_to_RVector(logact)
    
    args[&#39;autobalance&#39;] = autobalance
    
    if IS != None:
        args[&#34;IS&#34;] = _convert_to_RVector(IS, force_Rvec=False)
    
    with warnings.catch_warnings(record=True) as w:
        warnings.simplefilter(&#34;always&#34;)
        a = CHNOSZ.subcrt(**args)
    
    if messages:
        for warning in w:
            print(warning.message)
    
    if len(a) == 3:
        warn = a[2][0] # subcrt&#39;s list includes warnings only if they appear
    else:
        warn = None
    
    if not single_species:
        out_dict = {&#34;reaction&#34;:pandas2ri.ri2py_dataframe(a[0]),
                    &#34;out&#34;:pandas2ri.ri2py_dataframe(a[1])} # the extra [0] is important
    else:
        out_dict = {&#34;species&#34;:pandas2ri.ri2py_dataframe(a[0]), &#34;out&#34;:{}}
        
        i=0
        for df in a[1]:
            out_dict[&#34;out&#34;][out_dict[&#34;species&#34;].name[i]] = pandas2ri.ri2py_dataframe(df)
            i += 1
        
    if warn != None:
        out_dict[&#34;warnings&#34;] = warn
    
    out = SubcrtOutput(out_dict)
    
    if show:
        for table in out.__dict__.keys():
            if not isinstance(out[table], dict):
                display(out[table])
            else:
                for subtable in out[table].keys():
                    print(&#34;\n&#34;+subtable+&#34;:&#34;) # species name
                    display(out[table][subtable])
    
    return out</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pyCHNOSZ.fun.SubcrtOutput"><code class="flex name class">
<span>class <span class="ident">SubcrtOutput</span></span>
<span>(</span><span>args)</span>
</code></dt>
<dd>
<div class="desc"><p>Stores the output of a <code><a title="pyCHNOSZ.fun.subcrt" href="#pyCHNOSZ.fun.subcrt">subcrt()</a></code> calculation.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>reaction</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>Pandas dataframe summary of the reaction. Only present if a reaction is
specified.</dd>
<dt><strong><code>species</code></strong> :&ensp;<code>pd.Dataframe</code></dt>
<dd>Pandas dataframe summary of species. Only present if a reaction is not
specified.</dd>
<dt><strong><code>out</code></strong> :&ensp;<code>pd.Dataframe</code></dt>
<dd>Pandas dataframe of <code><a title="pyCHNOSZ.fun.subcrt" href="#pyCHNOSZ.fun.subcrt">subcrt()</a></code> output.</dd>
<dt><strong><code>warnings</code></strong> :&ensp;<code>pd.Dataframe</code></dt>
<dd>Pandas dataframe of calculation warnings. Only present if warnings were
generated.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SubcrtOutput(object):
    &#34;&#34;&#34;
    Stores the output of a `subcrt` calculation.
    
    Attributes
    ----------
    reaction : pd.DataFrame
        Pandas dataframe summary of the reaction. Only present if a reaction is
        specified.
        
    species : pd.Dataframe
        Pandas dataframe summary of species. Only present if a reaction is not
        specified.
        
    out : pd.Dataframe
        Pandas dataframe of `subcrt` output.
        
    warnings : pd.Dataframe
        Pandas dataframe of calculation warnings. Only present if warnings were
        generated.
        
    &#34;&#34;&#34;
    def __init__(self, args): 
        for k in args:
            setattr(self, k, args[k])

    def __getitem__(self, item):
         return getattr(self, item)</code></pre>
</details>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="pyCHNOSZ" href="index.html">pyCHNOSZ</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="pyCHNOSZ.fun.add_OBIGT" href="#pyCHNOSZ.fun.add_OBIGT">add_OBIGT</a></code></li>
<li><code><a title="pyCHNOSZ.fun.affinity" href="#pyCHNOSZ.fun.affinity">affinity</a></code></li>
<li><code><a title="pyCHNOSZ.fun.basis" href="#pyCHNOSZ.fun.basis">basis</a></code></li>
<li><code><a title="pyCHNOSZ.fun.diagram" href="#pyCHNOSZ.fun.diagram">diagram</a></code></li>
<li><code><a title="pyCHNOSZ.fun.equilibrate" href="#pyCHNOSZ.fun.equilibrate">equilibrate</a></code></li>
<li><code><a title="pyCHNOSZ.fun.info" href="#pyCHNOSZ.fun.info">info</a></code></li>
<li><code><a title="pyCHNOSZ.fun.mod_OBIGT" href="#pyCHNOSZ.fun.mod_OBIGT">mod_OBIGT</a></code></li>
<li><code><a title="pyCHNOSZ.fun.reset" href="#pyCHNOSZ.fun.reset">reset</a></code></li>
<li><code><a title="pyCHNOSZ.fun.species" href="#pyCHNOSZ.fun.species">species</a></code></li>
<li><code><a title="pyCHNOSZ.fun.subcrt" href="#pyCHNOSZ.fun.subcrt">subcrt</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pyCHNOSZ.fun.SubcrtOutput" href="#pyCHNOSZ.fun.SubcrtOutput">SubcrtOutput</a></code></h4>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>